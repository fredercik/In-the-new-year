DATA SEGMENT
	IO8255_MODE 	EQU 28BH
	IO8255A 		EQU 28AH
	IO8255C 		EQU 288H
	LED 			DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,6FH ;段码
	BZ 			DW 1 ;位码
DATA ENDS

CODE SEGMENT
	ASSUME CS:CODE,DS:DATA
START:
	MOV AX,DATA
	MOV DS,AX
	MOV DX,IO8255_MODE ;8255初始化
	MOV AL,80H
	OUT DX,AL
LOOP1: 
	MOV CX,0100H ;延时
LOOP2: 
	MOV BH,01
LLL: 
	MOV BYTE PTR BZ,BH
	PUSH DI
	DEC DI
	ADD DI, BZ

	MOV BL,[DI] ;BL为要显示的数
	POP DI
	MOV BH,0

	MOV SI,OFFSET LED ;置LED数码表偏移地址为SI
	ADD SI,BX ;求出对应的LED数码
	MOV AL,BYTE PTR [SI]

	MOV DX,IO8255C ;自8255C的口输出
	OUT DX,AL

	MOV AL,BYTE PTR BZ ;使相应的数码管亮
	MOV DX,IO8255A
	OUT DX,AL
	PUSH CX
 	MOV CX,100
DELAY: 
	LOOP DELAY ;延时
	POP CX
	MOV AL,00H
	OUT DX,AL
	MOV BH,BYTE PTR BZ
	SHR BH,1
	JNZ LLL
	LOOP LOOP2 ;循环延时

	MOV AX,WORD PTR [DI]

	CMP AL,09
	JNZ SET

	MOV AX,0000
	MOV [DI],AL
	JMP LOOP1
SET:
	MOV AX,WORD PTR [DI]
	INC AL
	AAA
	MOV [DI],AL 
	JMP LOOP1

	MOV AH,4CH ;返回
	INT 21H
CODE ENDS
	END START

